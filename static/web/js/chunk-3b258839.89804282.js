(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b258839"],{"4eb1":function(e,t,n){},"99c9":function(e,t,n){"use strict";n("9f6b")},"9f6b":function(e,t,n){},a55a:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"root"},[t("div",{staticStyle:{display:"flex"}},[t("div",{ref:"canvas",staticClass:"canvasPanel",style:{height:e.height+"px",width:"100%","border-bottom":0}})])])},r=[],a=(n("8e6e"),n("456d"),n("6762"),n("2fdb"),n("ade3")),s=(n("55dd"),n("7514"),n("20d6"),n("ac6a"),n("c5f6"),n("9d67")),c=n.n(s),o=n("e96b"),u=n("49da"),d=n("8de1"),f=n("e805"),h=n("1d16");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object(f["a"])(c.a),Object(h["a"])(c.a);var g={name:"WfdVueViewer",components:{},provide:function(){return{i18n:u["a"][this.lang]}},props:{height:{type:Number,default:800},lang:{type:String,default:"zh"},data:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{resizeFunc:function(){},selectedModel:{},previous:"",processModel:{id:"",name:"",clazz:"process",dataObjs:[],signalDefs:[],messageDefs:[]},graph:null}},watch:{data:function(e,t){e!==t&&this.graph&&(this.graph.changeData(this.initShape(t)),this.graph.emit("canvas:click"),this.graph.fitView("both"))}},destroyed:function(){window.removeEventListener("resize",this.resizeFunc),this.graph.getNodes().forEach((function(e){e.getKeyShape().stopAnimate()}))},mounted:function(){var e=this,t=this.$refs["canvas"].offsetWidth;this.graph=new c.a.Graph({plugins:[],container:this.$refs["canvas"],height:this.height,width:t,modes:{view:["drag-canvas","zoom-canvas"]},defaultEdge:{shape:"flow-polyline-round"}}),this.graph.saveXML=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(d["a"])(e.graph.save(),e.processModel,t)},this.graph.setMode("view"),this.graph.data(this.initShape(this.data)),this.graph.render(),this.data&&this.data.nodes&&this.graph.fitView(5),this.initEvents()},methods:{initShape:function(e){if(!e)return e;var t=e.nodes,n=e.edges,i=e.circulationHistory,r=e.currentNode;if(t){var a=[],s=i.findIndex((function(e){return""===e.target&&""===e.source&&"结束"===e.circulation})),c=s>-1?i.slice(s):i,u=c.map((function(e){return t.find((function(t){return t.id===e.target}))})).map((function(e){return e&&parseInt(e.sort)}));c=c.filter((function(e,t){return!isNaN(u[t])})),u=u.filter((function(e){return!isNaN(e)}));var d=u[0],f=function(){var e=--d,n=u.lastIndexOf(e);if(n>-1)a.push(c[n].target);else{var i=t.filter((function(t){return t.sort==="".concat(e)&&(t.clazz.includes("Gateway")||t.clazz.includes("start"))}));i.length>0&&a.push(i[0].id)}};while(d>0)f();return a=a.filter((function(e,t){if(!a[t+1])return!0;var i=n.some((function(n){return n.source===a[t+1]&&n.target===e}));return i})),{nodes:t.map((function(e){var t=r[0]&&r[0].id===e.id;return p(p({},e),{},{shape:Object(o["a"])(e.clazz,!t&&!a.includes(e.id)),style:t?{}:a.includes(e.id)?{stroke:"#13ce66",fill:"#d0f5e0"}:{stroke:"#999",fill:"#eee"}})})),edges:n.map((function(e){var t=e.source,n=e.target,i=a.indexOf(t),s=a.indexOf(n),c=i>-1&&s>-1&&i-s===1,o=0===i&&-1===s&&r[0]&&r[0].id===n;return c||o?p(p({},e),{},{style:{stroke:"#13ce66",lineWidth:2}}):e}))}}return e},initEvents:function(){var e=this.$refs["canvas"],t=this.graph,n=this.height-1;this.resizeFunc=function(){t.changeSize(e.offsetWidth,n)},window.addEventListener("resize",this.resizeFunc)}}},v=g,b=(n("99c9"),n("c21b"),n("2877")),w=Object(b["a"])(v,i,r,!1,null,"6d773ef1",null);t["default"]=w.exports},c21b:function(e,t,n){"use strict";n("4eb1")}}]);